1) write a sql to get all the orders where customers name has "a" as second character and "d" as fourth character

select * from Orders
where customer_name like '_a%' and customer_name like '___d%'

OR w can
select * from Orders where customer_name like '_a_d%'


2) write a sql to get all the orders placed in the month of dec 2020

Select * from Orders where DATEPART(YEAR, order_date) = '2020' and DATEPART(MONTH, order_date) = '12'

Or we can
Select * from Orders where order_date between '2020-12-01' and '2020-12-31'


3) write a query to get all the orders where ship_mode is neither in 'Standard Class' nor in 'First Class' and ship_date is
after nov 2020

select * from Orders where ship_mode not in ('Standard Class', 'First Class') and ship_date > '2020-11-30'


4) write a query to get all the orders where customer name neither start with "A" and nor ends with "n"

Select * from Orders where customer_name not like 'A%n'


5) write a query to get all the orders where profit is negative

select * from Orders where profit < 0


6) write a query to get all the orders where either quantity is less than 3 or profit is 0

select * from Orders where quantity < 3 or profit = 0


7) your manager handles the sales for South region and he wants you to create a report of all the orders in his region 
here some discount is provided to the customers

select * from Orders where region = 'South' and discount > 0


8) write a query to find top 5 orders with highest sales in furniture category 

select top 5 * from Orders where category = 'Furniture' order by sales desc


9)write a query to find all the records in technology and furniture category for the orders placed in the year 2020 only

select * from Orders where category in ('Furniture', 'Technology') 
and order_date between '2020-01-01' and '2020-12-31'


OR we can 
select * from Orders where category in ('Furniture', 'Technology')
and datepart(YEAR, order_date) = '2020'

10) write a query to find all the orders where order date is in year 2020 but ship date is in 2021

select * from Orders where order_date between '2020-01-01' and '2020-12-31'
and ship_date between '2021-01-01' and '2021-12-31'

Or we can
select * from Orders where DATEPART(YEAR, order_date) = '2020' and
DATEPART(YEAR, ship_date) = '2021'


11) write a update statement to update city as null for order ids :  CA-2020-161389 , US-2021-156909

update orders set city=null where order_id in ('CA-2020-161389','US-2021-156909')


12) write a query to find orders where city is null

select * from orders where city is null


13) write a query to get total profit, first order date and latest order date for each category

select sum(sales) as Total_profit, min(order_date) as first_order_date, max(order_date) as latest_ordr_date
from Orders group by category


14) write a query to find sub-categories where average profit is more than the half of the max profit 
in that sub-category

select sub_category from Orders group by sub_category having avg(profit) > 0.5 * Max(profit)


